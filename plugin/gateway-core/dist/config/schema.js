// Defines safe gateway defaults for production usage.
export const DEFAULT_GATEWAY_CONFIG = {
    hooks: {
        enabled: true,
        disabled: [],
        order: [
            "autopilot-loop",
            "continuation",
            "tool-output-truncator",
            "semantic-output-summarizer",
            "context-window-monitor",
            "preemptive-compaction",
            "session-recovery",
            "delegate-task-retry",
            "validation-evidence-ledger",
            "parallel-opportunity-detector",
            "read-budget-optimizer",
            "adaptive-validation-scheduler",
            "stop-continuation-guard",
            "keyword-detector",
            "auto-slash-command",
            "rules-injector",
            "directory-agents-injector",
            "directory-readme-injector",
            "noninteractive-shell-guard",
            "write-existing-file-guard",
            "agent-reservation-guard",
            "subagent-question-blocker",
            "tasks-todowrite-disabler",
            "task-resume-info",
            "empty-task-response-detector",
            "comment-checker",
            "agent-user-reminder",
            "unstable-agent-babysitter",
            "question-label-truncator",
            "dangerous-command-guard",
            "secret-leak-guard",
            "secret-commit-guard",
            "workflow-conformance-guard",
            "scope-drift-guard",
            "done-proof-enforcer",
            "dependency-risk-guard",
            "docs-drift-guard",
            "hook-test-parity-guard",
            "retry-budget-guard",
            "stale-loop-expiry-guard",
            "parallel-writer-conflict-guard",
            "branch-freshness-guard",
            "pr-readiness-guard",
            "pr-body-evidence-guard",
            "merge-readiness-guard",
            "gh-checks-merge-guard",
            "post-merge-sync-guard",
            "safety",
        ],
    },
    autopilotLoop: {
        enabled: true,
        maxIterations: 0,
        orphanMaxAgeHours: 12,
        bootstrapFromRuntimeOnIdle: false,
        maxIgnoredCompletionCycles: 1,
        completionMode: "promise",
        completionPromise: "DONE",
    },
    toolOutputTruncator: {
        enabled: true,
        maxChars: 12000,
        maxLines: 220,
        tools: ["bash", "Bash", "read", "Read", "grep", "Grep", "webfetch", "WebFetch", "glob", "Glob"],
    },
    contextWindowMonitor: {
        enabled: true,
        warningThreshold: 0.7,
    },
    preemptiveCompaction: {
        enabled: true,
        warningThreshold: 0.78,
    },
    sessionRecovery: {
        enabled: true,
        autoResume: true,
    },
    delegateTaskRetry: {
        enabled: true,
    },
    validationEvidenceLedger: {
        enabled: true,
    },
    parallelOpportunityDetector: {
        enabled: true,
    },
    readBudgetOptimizer: {
        enabled: true,
        smallReadLimit: 80,
        maxConsecutiveSmallReads: 3,
    },
    adaptiveValidationScheduler: {
        enabled: true,
        reminderEditThreshold: 3,
    },
    stopContinuationGuard: {
        enabled: true,
    },
    keywordDetector: {
        enabled: true,
    },
    autoSlashCommand: {
        enabled: true,
    },
    rulesInjector: {
        enabled: true,
    },
    directoryAgentsInjector: {
        enabled: true,
    },
    directoryReadmeInjector: {
        enabled: true,
    },
    noninteractiveShellGuard: {
        enabled: true,
        blockedPatterns: [
            "\\b(vim|vi|nano|emacs|less|more|man)\\b",
            "\\bgit\\s+add\\s+-p\\b",
            "\\bgit\\s+rebase\\s+-i\\b",
        ],
    },
    writeExistingFileGuard: {
        enabled: true,
    },
    agentReservationGuard: {
        enabled: true,
        enforce: false,
        reservationEnvKeys: ["AGENTMAIL_RESERVATION_ACTIVE", "MY_OPENCODE_FILE_RESERVATION_ACTIVE"],
    },
    subagentQuestionBlocker: {
        enabled: true,
        sessionPatterns: ["task-", "subagent"],
    },
    tasksTodowriteDisabler: {
        enabled: true,
    },
    taskResumeInfo: {
        enabled: true,
    },
    emptyTaskResponseDetector: {
        enabled: true,
    },
    commentChecker: {
        enabled: true,
    },
    agentUserReminder: {
        enabled: true,
    },
    unstableAgentBabysitter: {
        enabled: true,
        riskyPatterns: ["experimental", "preview", "unstable"],
    },
    questionLabelTruncator: {
        enabled: true,
        maxLength: 30,
    },
    semanticOutputSummarizer: {
        enabled: true,
        minChars: 20000,
        minLines: 400,
        maxSummaryLines: 8,
    },
    dangerousCommandGuard: {
        enabled: true,
        blockedPatterns: [
            "\\brm\\s+-rf\\b",
            "\\bgit\\s+reset\\s+--hard\\b",
            "\\bgit\\s+checkout\\s+--\\b",
            "\\bgit\\s+clean\\s+-fdx\\b",
            "\\bgit\\s+push\\s+--force\\b",
            "curl\\s+[^|]+\\|\\s*bash",
        ],
    },
    secretLeakGuard: {
        enabled: true,
        redactionToken: "[REDACTED_SECRET]",
        patterns: [
            "sk-[A-Za-z0-9]{20,}",
            "ghp_[A-Za-z0-9]{20,}",
            "AIza[0-9A-Za-z\\-_]{20,}",
            "-----BEGIN (RSA|EC|OPENSSH|DSA|PRIVATE) KEY-----",
            "(?i)(api[_-]?key|token|secret|password)\\s*[:=]\\s*['\"]?[A-Za-z0-9_\\-]{12,}",
        ],
    },
    workflowConformanceGuard: {
        enabled: true,
        protectedBranches: ["main", "master"],
        blockEditsOnProtectedBranches: true,
    },
    scopeDriftGuard: {
        enabled: false,
        allowedPaths: [],
        blockOnDrift: true,
    },
    doneProofEnforcer: {
        enabled: true,
        requiredMarkers: ["validation", "test", "lint"],
        requireLedgerEvidence: true,
        allowTextFallback: true,
    },
    dependencyRiskGuard: {
        enabled: true,
        lockfilePatterns: ["package-lock.json", "pnpm-lock.yaml", "yarn.lock", "poetry.lock", "uv.lock", "Cargo.lock"],
        commandPatterns: [
            "\\bnpm\\s+(install|update|uninstall|audit\\s+fix)\\b",
            "\\bpnpm\\s+(install|update|remove|audit)\\b",
            "\\byarn\\s+(add|remove|upgrade|install)\\b",
            "\\bbun\\s+add\\b",
            "\\buv\\s+(add|remove|sync)\\b",
            "\\bcargo\\s+(add|remove|update)\\b",
        ],
    },
    docsDriftGuard: {
        enabled: true,
        sourcePatterns: ["plugin/gateway-core/src/**", "plugin/gateway-core/package.json"],
        docsPatterns: ["README.md", "docs/**", "plugin/gateway-core/**/*.md"],
        blockOnDrift: false,
    },
    hookTestParityGuard: {
        enabled: true,
        sourcePatterns: ["plugin/gateway-core/src/hooks/**/*.ts"],
        testPatterns: ["plugin/gateway-core/test/*-hook.test.mjs"],
        blockOnMismatch: true,
    },
    retryBudgetGuard: {
        enabled: true,
        maxRetries: 3,
    },
    staleLoopExpiryGuard: {
        enabled: true,
        maxAgeMinutes: 120,
    },
    branchFreshnessGuard: {
        enabled: true,
        baseRef: "origin/main",
        maxBehind: 0,
        enforceOnPrCreate: true,
        enforceOnPrMerge: true,
    },
    prReadinessGuard: {
        enabled: true,
        requireCleanWorktree: true,
        requireValidationEvidence: true,
    },
    prBodyEvidenceGuard: {
        enabled: true,
        requireSummarySection: true,
        requireValidationSection: true,
        requireValidationEvidence: true,
        allowUninspectableBody: true,
    },
    mergeReadinessGuard: {
        enabled: true,
        requireDeleteBranch: true,
        requireStrategy: true,
        disallowAdminBypass: true,
    },
    ghChecksMergeGuard: {
        enabled: true,
        blockDraft: true,
        requireApprovedReview: true,
        requirePassingChecks: true,
        blockedMergeStates: ["BEHIND", "BLOCKED", "DIRTY"],
        failOpenOnError: false,
    },
    postMergeSyncGuard: {
        enabled: true,
        requireDeleteBranch: true,
        enforceMainSyncInline: false,
        reminderCommands: ["git checkout main", "git pull --rebase"],
    },
    parallelWriterConflictGuard: {
        enabled: true,
        maxConcurrentWriters: 2,
        writerCountEnvKeys: ["MY_OPENCODE_ACTIVE_WRITERS", "AGENTMAIL_ACTIVE_WRITERS"],
        reservationPathsEnvKeys: ["MY_OPENCODE_FILE_RESERVATION_PATHS", "AGENTMAIL_RESERVATION_PATHS"],
        activeReservationPathsEnvKeys: ["MY_OPENCODE_ACTIVE_RESERVATION_PATHS", "AGENTMAIL_ACTIVE_RESERVATION_PATHS"],
        enforceReservationCoverage: true,
    },
    secretCommitGuard: {
        enabled: true,
        patterns: [
            "sk-[A-Za-z0-9]{20,}",
            "ghp_[A-Za-z0-9]{20,}",
            "AIza[0-9A-Za-z\\-_]{20,}",
            "-----BEGIN (RSA|EC|OPENSSH|DSA|PRIVATE) KEY-----",
            "(?i)(api[_-]?key|token|secret|password)\\s*[:=]\\s*['\"]?[A-Za-z0-9_\\-]{12,}",
        ],
    },
    quality: {
        profile: "fast",
        ts: {
            lint: true,
            typecheck: true,
            tests: false,
        },
        py: {
            selftest: true,
        },
    },
};
